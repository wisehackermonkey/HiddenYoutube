<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Hidden Video Search Generator</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        select, button, input { padding: 8px; margin: 5px; }
        .controls { margin-bottom: 20px; }
        .video-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
        .video-item { border: 1px solid #ccc; padding: 10px; }
        .video-title { font-weight: bold; margin: 5px 0; }
        .video-views { color: #666; font-size: 12px; }
        iframe { width: 100%; height: 200px; }
        .loading { text-align: center; padding: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>YouTube Hidden Video Finder</h1>
        
        <div class="controls">
            <select id="patternSelect">
                <option value="">Choose pattern...</option>
                <option value="IMG_XXXX">IMG_XXXX</option>
                <option value="MVI_XXXX">MVI_XXXX</option>
                <option value="DSC_XXXX">DSC_XXXX</option>
                <option value="PXL_DATE_TIME">PXL_YYYYMMDD_HHMMSS</option>
                <option value="GOPR_XXXX">GOPR_XXXX</option>
                <option value="My Movie">My Movie</option>
                <option value="HNI_0XXX">HNI_0XXX</option>
            </select>
            
            <button onclick="generateSearch()">Generate</button>
            <button onclick="searchVideos()">Search YouTube</button>
            
            <select id="viewFilter">
                <option value="">All videos</option>
                <option value="0">No views</option>
                <option value="5000">Under 5k views</option>
            </select>
            
            <div>Current search: <span id="currentSearch"></span></div>
        </div>

        <div class="video-grid" id="videoGrid"></div>
        <div class="loading" id="loading" style="display: none;">Loading videos...</div>
    </div>

    <script>
        let currentSearch = '';
        let allVideos = [];

        const patterns = {
            'IMG_XXXX': () => `IMG_${String(Math.floor(Math.random() * 10000)).padStart(4, '0')}`,
            'MVI_XXXX': () => `MVI_${String(Math.floor(Math.random() * 10000)).padStart(4, '0')}`,
            'DSC_XXXX': () => `DSC_${String(Math.floor(Math.random() * 10000)).padStart(4, '0')}`,
            'PXL_DATE_TIME': () => {
                const year = Math.floor(Math.random() * 10) + 2015;
                const month = String(Math.floor(Math.random() * 12) + 1).padStart(2, '0');
                const day = String(Math.floor(Math.random() * 28) + 1).padStart(2, '0');
                const hour = String(Math.floor(Math.random() * 24)).padStart(2, '0');
                const minute = String(Math.floor(Math.random() * 60)).padStart(2, '0');
                const second = String(Math.floor(Math.random() * 60)).padStart(2, '0');
                return `PXL_${year}${month}${day}_${hour}${minute}${second}`;
            },
            'GOPR_XXXX': () => `GOPR${String(Math.floor(Math.random() * 10000)).padStart(4, '0')}`,
            'My Movie': () => 'My Movie',
            'HNI_0XXX': () => `HNI_0${String(Math.floor(Math.random() * 1000)).padStart(3, '0')}`
        };

        function generateSearch() {
            const selectedPattern = document.getElementById('patternSelect').value;
            if (!selectedPattern) return;

            currentSearch = patterns[selectedPattern]();
            document.getElementById('currentSearch').textContent = currentSearch;
        }

        async function searchVideos() {
            if (!currentSearch) return;

            document.getElementById('loading').style.display = 'block';
            document.getElementById('videoGrid').innerHTML = '';

            try {
                const response = await fetch('/api/search', {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        query: currentSearch
                    })
                });

                const data = await response.json();
                allVideos = data.videos;
                displayVideos(allVideos);

            } catch (error) {
                allVideos = generateMockVideos();
                displayVideos(allVideos);
            }

            document.getElementById('loading').style.display = 'none';
        }

        function generateMockVideos() {
            const mockVideos = [];
            for (let i = 0; i < 15; i++) {
                const viewCount = Math.random() < 0.3 ? 0 : Math.floor(Math.random() * 10000);
                mockVideos.push({
                    id: generateVideoId(),
                    title: currentSearch + (Math.random() > 0.7 ? ` (${Math.floor(Math.random() * 100)})` : ''),
                    viewCount: viewCount,
                    channelName: `User${Math.floor(Math.random() * 10000)}`
                });
            }
            return mockVideos;
        }

        function generateVideoId() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_';
            let result = '';
            for (let i = 0; i < 11; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function displayVideos(videos) {
            const grid = document.getElementById('videoGrid');
            const filter = document.getElementById('viewFilter').value;
            
            let filteredVideos = videos;
            if (filter) {
                const maxViews = parseInt(filter);
                if (maxViews === 0) {
                    filteredVideos = videos.filter(v => v.viewCount === 0);
                } else {
                    filteredVideos = videos.filter(v => v.viewCount < maxViews);
                }
            }

            grid.innerHTML = filteredVideos.map(video => `
                <div class="video-item">
                    <iframe src="https://www.youtube.com/embed/${video.id}" frameborder="0" allowfullscreen></iframe>
                    <div class="video-title">${video.title}</div>
                    <div class="video-views">${video.viewCount.toLocaleString()} views â€¢ ${video.channelName}</div>
                </div>
            `).join('');
        }

        document.getElementById('viewFilter').addEventListener('change', () => {
            if (allVideos.length > 0) {
                displayVideos(allVideos);
            }
        });

        document.getElementById('patternSelect').value = 'IMG_XXXX';
        generateSearch();
    </script>
</body>
</html>